import{b as N,d as q,e as j,f as z,g as W,h as B,i as A,p as U,q as L,r as Y,s as D,u as J}from"./chunk-QENRJ74P.js";import{c as E,e as T,i as V,j as x}from"./chunk-XP7GFRGV.js";import{Ea as I,Ia as g,Nb as k,Pa as s,Pb as O,Rb as R,Ta as i,Ua as n,Va as p,Ya as F,Z as v,Za as M,_,_a as m,db as u,eb as c,gb as b,hb as S,jb as h,kb as C,lb as y,rb as P,va as r,za as w}from"./chunk-RXLJ6G3Z.js";var G=(e,l,t,a)=>({"bg-success":e,"bg-warning":l,"bg-danger":t,"bg-secondary":a});function Q(e,l){e&1&&(i(0,"div",7)(1,"div",8),p(2,"div",9),i(3,"p",10),c(4,"Loading..."),n()()())}function H(e,l){if(e&1&&(i(0,"div",45),c(1),n()),e&2){let t=m(2);r(),S(" ",t.candidate.name," - ",t.step.stepName," ")}}function K(e,l){e&1&&(i(0,"div",45),c(1," Provide your detailed feedback and assessment "),n())}function X(e,l){if(e&1&&(i(0,"div",46),p(1,"i",47),c(2),n()),e&2){let t=m(2);r(2),b("",t.error," ")}}function Z(e,l){if(e&1&&(i(0,"div",48),p(1,"i",49),c(2),n()),e&2){let t=m(2);r(2),b("",t.success," ")}}function $(e,l){e&1&&(i(0,"span"),c(1,"Reviewer email is required"),n())}function ee(e,l){e&1&&(i(0,"span"),c(1,"Please enter a valid email address"),n())}function te(e,l){if(e&1&&(i(0,"div",50),g(1,$,2,0,"span",51)(2,ee,2,0,"span",51),n()),e&2){m();let t=u(18);r(),s("ngIf",t.errors==null?null:t.errors.required),r(),s("ngIf",t.errors==null?null:t.errors.email)}}function ne(e,l){e&1&&(i(0,"span"),c(1,"Score is required"),n())}function ie(e,l){e&1&&(i(0,"span"),c(1,"Score must be at least 0"),n())}function re(e,l){e&1&&(i(0,"span"),c(1,"Score must be at most 100"),n())}function oe(e,l){if(e&1&&(i(0,"div",50),g(1,ne,2,0,"span",51)(2,ie,2,0,"span",51)(3,re,2,0,"span",51),n()),e&2){m();let t=u(26);r(),s("ngIf",t.errors==null?null:t.errors.required),r(),s("ngIf",t.errors==null?null:t.errors.min),r(),s("ngIf",t.errors==null?null:t.errors.max)}}function ae(e,l){e&1&&(i(0,"span"),c(1,"Feedback is required"),n())}function de(e,l){if(e&1&&(i(0,"div",50),g(1,ae,2,0,"span",51),n()),e&2){m();let t=u(36);r(),s("ngIf",t.errors==null?null:t.errors.required)}}function se(e,l){e&1&&p(0,"span",52)}function ce(e,l){e&1&&p(0,"i",53)}function le(e,l){if(e&1){let t=F();i(0,"div",11)(1,"div",12)(2,"div",13),p(3,"i",14),n(),i(4,"h2",15),c(5,"Submit Review"),n(),g(6,H,2,2,"div",16)(7,K,2,0,"div",16),n(),g(8,X,3,1,"div",17)(9,Z,3,1,"div",18),i(10,"form",19,0),M("ngSubmit",function(){v(t);let o=m();return _(o.onSubmit())}),i(12,"div",20)(13,"div",21)(14,"label",22),p(15,"i",23),c(16,"Reviewer Email "),n(),i(17,"input",24,1),y("ngModelChange",function(o){v(t);let f=m();return C(f.reviewForm.reviewer,o)||(f.reviewForm.reviewer=o),_(o)}),n(),g(19,te,3,2,"div",25),n(),i(20,"div",21)(21,"label",26),p(22,"i",27),c(23,"Score (0-100) "),n(),i(24,"div",28)(25,"input",29,2),y("ngModelChange",function(o){v(t);let f=m();return C(f.reviewForm.score,o)||(f.reviewForm.score=o),_(o)}),n(),i(27,"div",30)(28,"span",31),c(29),n()()(),g(30,oe,4,3,"div",25),n(),i(31,"div",32)(32,"label",33),p(33,"i",34),c(34,"Feedback "),n(),i(35,"textarea",35,3),y("ngModelChange",function(o){v(t);let f=m();return C(f.reviewForm.feedback,o)||(f.reviewForm.feedback=o),_(o)}),n(),i(37,"div",36)(38,"small",37),p(39,"i",38),c(40),n()(),g(41,de,2,1,"div",25),n(),i(42,"div",39)(43,"button",40),M("click",function(){v(t);let o=m();return _(o.goBack())}),p(44,"i",41),c(45,"Back "),n(),i(46,"button",42),g(47,se,1,0,"span",43)(48,ce,1,0,"i",44),c(49),n()()()()()}if(e&2){let t=u(11),a=u(18),o=u(26),f=u(36),d=m();r(6),s("ngIf",d.candidate&&d.step),r(),s("ngIf",!d.candidate||!d.step),r(),s("ngIf",d.error),r(),s("ngIf",d.success),r(8),h("ngModel",d.reviewForm.reviewer),r(2),s("ngIf",a.invalid&&a.touched),r(6),h("ngModel",d.reviewForm.score),r(3),s("ngClass",P(17,G,d.reviewForm.score>=70,d.reviewForm.score>=40&&d.reviewForm.score<70,d.reviewForm.score<40,d.reviewForm.score===0||!d.reviewForm.score)),r(),b(" ",d.reviewForm.score||0,"% "),r(),s("ngIf",o.invalid&&o.touched),r(5),h("ngModel",d.reviewForm.feedback),r(5),b(" Character count: ",d.reviewForm.feedback.length||0," "),r(),s("ngIf",f.invalid&&f.touched),r(5),s("disabled",t.invalid||d.loading),r(),s("ngIf",d.loading),r(),s("ngIf",!d.loading),r(),b(" ",d.loading?"Submitting...":"Submit Review"," ")}}var we=(()=>{class e{route;router;apiService;candidateId=0;stepId=0;candidate=null;step=null;loading=!1;error=null;success=null;reviewForm={reviewer:"",feedback:"",score:0};constructor(t,a,o){this.route=t,this.router=a,this.apiService=o}ngOnInit(){this.candidateId=Number(this.route.snapshot.paramMap.get("id")),this.stepId=Number(this.route.snapshot.paramMap.get("stepId"));let t=localStorage.getItem("currentUser");if(t){let a=JSON.parse(t);this.reviewForm.reviewer=a.email||"interviewer@example.com"}else this.reviewForm.reviewer="interviewer@example.com";this.loadCandidateAndStep()}loadCandidateAndStep(){this.loading=!0,this.apiService.getCandidateById(this.candidateId).subscribe({next:t=>{this.candidate=t,this.loadStep()},error:t=>{let a=x.getFallbackCandidates().find(o=>o.id===this.candidateId);a?(this.candidate=a,this.loadStep()):(this.error="Candidate not found",this.loading=!1)}})}loadStep(){this.apiService.getCandidateSteps(this.candidateId).subscribe({next:t=>{this.step=t.find(a=>a.id===this.stepId)||null,this.loading=!1},error:t=>{let a=x.getFallbackCandidateSteps(this.candidateId);this.step=a.find(o=>o.id===this.stepId)||null,this.loading=!1}})}onSubmit(){this.isFormValid()&&(this.loading=!0,this.error=null,this.success=null,this.apiService.createReview(this.stepId,this.reviewForm).subscribe({next:t=>{this.success="Review submitted successfully!",this.loading=!1,setTimeout(()=>{this.router.navigate(["/candidates/view-candidate",this.candidateId])},2e3)},error:t=>{this.error="Failed to submit review. Please try again.",this.loading=!1}}))}isFormValid(){return this.reviewForm.reviewer.trim()?this.reviewForm.feedback.trim()?this.reviewForm.score<0||this.reviewForm.score>100?(this.error="Score must be between 0 and 100",!1):!0:(this.error="Feedback is required",!1):(this.error="Reviewer email is required",!1)}goBack(){this.router.navigate(["/candidates/view-candidate",this.candidateId])}static \u0275fac=function(a){return new(a||e)(w(E),w(T),w(x))};static \u0275cmp=I({type:e,selectors:[["app-review-form"]],decls:3,vars:2,consts:[["reviewFormRef","ngForm"],["reviewerInput","ngModel"],["scoreInput","ngModel"],["feedbackInput","ngModel"],[1,"review-form-bg","d-flex","align-items-center","justify-content-center","min-vh-90","w-100"],["class","d-flex justify-content-center align-items-center","style","min-height: 400px;",4,"ngIf"],["class","review-form-card p-5 shadow-lg w-100",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"min-height","400px"],[1,"text-center"],["role","status",1,"spinner-border","text-primary","mb-3",2,"width","3rem","height","3rem"],[1,"text-muted","fs-5"],[1,"review-form-card","p-5","shadow-lg","w-100"],[1,"text-center","mb-4"],[1,"brand-icon","mb-2"],[1,"fas","fa-star"],[1,"brand-heading","mb-1"],["class","brand-subheading mb-3",4,"ngIf"],["class","alert alert-danger border-0 rounded-3 mb-4",4,"ngIf"],["class","alert alert-success border-0 rounded-3 mb-4",4,"ngIf"],[3,"ngSubmit"],[1,"row","g-4"],[1,"col-md-6"],["for","reviewer",1,"form-label"],[1,"fas","fa-user","me-2","text-primary"],["type","email","id","reviewer","name","reviewer","required","","email","","placeholder","Enter your email address",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger small mt-1",4,"ngIf"],["for","score",1,"form-label"],[1,"fas","fa-chart-line","me-2","text-success"],[1,"score-input-container"],["type","number","id","score","name","score","required","","min","0","max","100","placeholder","Enter score",1,"form-control",3,"ngModelChange","ngModel"],[1,"score-preview"],[1,"badge","fs-6","px-3","py-2",3,"ngClass"],[1,"col-12"],["for","feedback",1,"form-label"],[1,"fas","fa-comment-alt","me-2","text-info"],["id","feedback","name","feedback","required","","rows","6","placeholder","Provide detailed feedback about the candidate's performance in this step...",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],[1,"text-muted"],[1,"fas","fa-info-circle","me-1"],[1,"col-12","d-flex","justify-content-between","align-items-center","mt-4"],["type","button",1,"btn","brand-outline-btn",3,"click"],[1,"fas","fa-arrow-left","me-1"],["type","submit",1,"btn","brand-green-btn","px-4",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],["class","fas fa-paper-plane me-2",4,"ngIf"],[1,"brand-subheading","mb-3"],[1,"alert","alert-danger","border-0","rounded-3","mb-4"],[1,"fas","fa-exclamation-circle","me-2"],[1,"alert","alert-success","border-0","rounded-3","mb-4"],[1,"fas","fa-check-circle","me-2"],[1,"text-danger","small","mt-1"],[4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-paper-plane","me-2"]],template:function(a,o){a&1&&(i(0,"div",4),g(1,Q,5,0,"div",5)(2,le,50,22,"div",6),n()),a&2&&(r(),s("ngIf",o.loading),r(),s("ngIf",!o.loading))},dependencies:[R,k,O,J,B,N,A,q,j,Y,D,L,U,W,z,V],styles:[`.review-form-bg[_ngcontent-%COMP%]{background:linear-gradient(120deg,#f3f7fa,#e9f7ef);min-height:90vh;width:100%;z-index:0;display:flex;align-items:center;justify-content:center}.review-form-card[_ngcontent-%COMP%]{background:#fdfdfd;border-radius:28px;box-shadow:0 12px 40px #3c3c3c21,0 2px 8px #3c3c3c17;width:100%;max-width:900px;padding:3rem 2.5rem;animation:_ngcontent-%COMP%_fadeInUp .7s cubic-bezier(.39,.575,.565,1) both}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(40px)}to{opacity:1;transform:none}}.brand-heading[_ngcontent-%COMP%]{color:#d2f55b;font-weight:700;letter-spacing:1px;font-size:2.1rem}.brand-subheading[_ngcontent-%COMP%]{color:#888;font-size:1.1rem;font-weight:400}.brand-icon[_ngcontent-%COMP%]{background:#cad2ff;color:#222;width:54px;height:54px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;margin:0 auto .5rem}.brand-green-btn[_ngcontent-%COMP%]{background:#d2f55b;color:#222;border:none;border-radius:8px;font-weight:600;transition:background .2s;box-shadow:0 2px 8px #d2f55b14}.brand-green-btn[_ngcontent-%COMP%]:hover{background:#cad2ff;color:#222}.brand-outline-btn[_ngcontent-%COMP%]{border:2px solid rgb(210,245,91);color:#d2f55b;background:transparent;border-radius:8px;font-weight:600;transition:background .2s,color .2s}.brand-outline-btn[_ngcontent-%COMP%]:hover{background:#d2f55b;color:#222}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#444}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #e0e0e0;background:#f8fafd;font-size:1rem;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#d2f55b;box-shadow:0 0 0 2px #d2f55b26}.score-input-container[_ngcontent-%COMP%]{position:relative}.score-preview[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);z-index:1}.score-preview[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{border-radius:20px;min-width:60px;text-align:center}.alert[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease;border-radius:12px;border:none;box-shadow:0 4px 12px #0000001a}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}textarea.form-control[_ngcontent-%COMP%]{transition:all .3s ease;resize:none}textarea.form-control[_ngcontent-%COMP%]:focus{min-height:150px}.form-text[_ngcontent-%COMP%]{margin-top:.5rem}.text-danger[_ngcontent-%COMP%]{font-size:.875rem;margin-top:.25rem}.form-label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.7}@media (max-width: 900px){.review-form-card[_ngcontent-%COMP%]{max-width:98vw;padding:2rem 1rem}.brand-heading[_ngcontent-%COMP%]{font-size:1.8rem}.brand-subheading[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 576px){.review-form-card[_ngcontent-%COMP%]{padding:1.5rem 1rem}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.d-flex.justify-content-between[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.spinner-border[_ngcontent-%COMP%]{color:#d2f55b!important}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}
/*# sourceMappingURL=review-form.component-QUYJ3RBJ.css.map */`]})}return e})();export{we as ReviewFormComponent};
//# sourceMappingURL=chunk-QSKU5GJO.js.map
